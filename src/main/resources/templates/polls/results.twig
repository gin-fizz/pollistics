{% extends "../layouts/main.twig" %}

{% block pageTitle %}{{ poll.title }}{% endblock %}
{% block description %}{{ poll.title }} {{ poll.options }}{% endblock %}

{% block content %}
	<h1>{{ poll.title }}</h1>
	<div id="results"></div>

	<div class="social">
		<div class="social--item">
			<a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fpollistics.com%2F{% if poll.slug is empty %}{{ poll.id }}{% else %}{{ poll.slug }}{% endif %}&quote={{poll.title|url_encode}}" target="_blank" rel="noopener" class="cta">share on facebook</a>
			<a href="https://twitter.com/intent/tweet?text={{ poll.title ~ "\n\n" ~ "via Pollistics â€” https://pollistics.com/" | url_encode }}{% if poll.slug is empty %}{{ poll.id }}{% else %}{{ poll.slug }}{% endif %}" target="_blank" rel="noopener" class="cta">share on twitter</a>
		</div>
		<div class="social--item" id="social"></div>
	</div>
{% endblock %}

{% block scripts %}
	<style>
		.arc text {
			font: 10px sans-serif;
			text-anchor: middle;
			color:white;
		}

		.arc path {
			stroke: #fff;
		}
	</style>
	<style>

		.toolTip {
			font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
			position: absolute;
			display: none;
			width: auto;
			height: auto;
			background: none repeat scroll 0 0 white;
			border: 0 none;
			border-radius: 8px 8px 8px 8px;
			box-shadow: -3px 3px 15px #888888;
			color: black;
			font: 12px sans-serif;
			padding: 5px;
			text-align: center;
		}

		text {
			font: 10px sans-serif;
			color: white;
		}
		text.value {
			font-size: 100%;
			fill: white;
		}

		text.value2 {
			font-size: 100%;
			fill: #2660A4;
		}

		.axisHorizontal path{
			fill: none;
		}

		.axisHorizontal .tick line {
			stroke-width: 1;
			stroke: rgba(0, 0, 0, 0.2);
		}

		.bar {
			fill: #2660A4;
			fill-opacity: .9;
		}

	</style>
	<script src="{{ asset('node_modules/d3/build/d3.min.js') }}"></script>
	<script src="{{ asset('node_modules/d3-tip/index.js') }}"></script>
	<script>
		var data = []; // todo: do this with jsonify stuff
		{% for option, nVotes in poll.options -%}
		data.push({label: "{{option}}", value: {{ nVotes }}});
		{% endfor %}
	</script>
	<script src="/js/dist/results.js"></script>
{% endblock %}
